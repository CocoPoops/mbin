{% extends 'base.html.twig' %}

{%- block title -%}
    {% if is_sub_page() %}
        {{- 'topbar.subscriptions'|trans }}: {{ 'comments'|trans -}}
    {% elseif is_mod_page() %}
        {{- 'topbar.moderated'|trans }}: {{ 'comments'|trans -}}
    {% elseif is_magazine_page() %}
        {{- magazine.title }}: {{ 'comments'|trans -}}
    {% else %}
        {{- 'comments'|trans ~ ' - ' ~ kbin_meta_title() -}}
    {% endif %}
{%- endblock -%}

{%- block description -%}{{- magazine is defined ? magazine.description ? get_short_desc(magazine.description) : '' : kbin_meta_description() -}}{%- endblock -%}

{% block image %}{{ magazine is defined ? magazine.cover ? uploaded_asset(magazine.cover.filePath) : '' : '' }}{% endblock %}


{% block body %}
    <div class="kbin-comment-wrapper">
        {% if magazine is defined %}
            {{ component('title', {title: magazine.title, url: path('front_magazine', {name: magazine.name})}) }}
            {% include 'magazine/_nav.html.twig' %}
        {% endif %}
        {% include '_layout/_filters.html.twig' %}
        {% include '_layout/_flash.html.twig' %}
        <h1 class="mt-2 text-muted display-none">{{ magazine is defined ? magazine.title ~ ': ' : '' }}{{ 'comments'|trans }}</h1>
        {% if magazine is defined and magazine.isAdult and (not app.user or app.user.hideAdult) %}
            {% include '_layout/_adult.html.twig' %}
        {% else %}
            {% include 'entry/comment/_list.html.twig' %}
        {% endif %}
    </div>
{% endblock %}

{% block sidebar %}
    {{ parent() }}

    {% if is_magazine_page() %}
        {% include 'magazine/_sidebar.html.twig' %}
    {% endif %}
{% endblock %}

{% block sidebar_bottom %}
    {% if magazine is defined %}
        {{ component('related_entries_sidebar', {tag: magazine.name}) }}
        {{ component('related_posts_sidebar', {tag: magazine.name}) }}
    {% else %}
        {{ component('related_entries_sidebar', {type: 'random'}) }}
        {{ component('related_posts_sidebar', {type: 'random'}) }}
    {% endif %}
{% endblock %}
