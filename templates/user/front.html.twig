{% extends 'base.html.twig' %}
{% from '_layout/_not_found.html.twig' import not_found %}
{% from 'user/_macros.html.twig' import avatar %}

{%- block title -%}{{- user.username }} - {{ 'overview'|trans -}}{%- endblock -%}

{% block body %}
    {% if user.cover %}
        <div style="height:220px; background: url({{ asset(user.cover.filePath) |imagine_filter('user_cover') }}) center; background-size:cover;">
        </div>
    {% else %}
        <div style="height:50px;"></div>
    {% endif %}

    <div class="d-flex justify-content-md-between justify-content-center bd-highlight px-3">
        <div class="bd-highlight text-center position-relative" style="top:-35px">
            <div class="pb-2">
                {% if user.avatar %}
                    <div class="kbin-user-avatar">
                        {{ avatar(user) }}
                    </div>
                {% endif %}
            </div>
            <div>
                <h3 class="font-weight-bold pt-2 mb-2 h5 d-inline ">
                    <a href="{{ user.apProfileId ?? '#' }}"
                       rel="{{ user.appProfileId ? 'nofollow noopener noreferrer' : '' }}"
                       class="text-reset">{{ user.apPreferredUsername ?? user.username |trim('@', 'left') }}</a>
                </h3>
                    <div class="mb-2 small">
                        {% if user.apProfileId %}
                        <small class="small text-muted">{{ user.email }}</small>
                        {% else %}
                            <small class="small text-muted">{{ user.username ~ '@' ~ kbin_domain() }}</small>
                        {% endif %}
                    </div>
                <div>
                    {% include 'user/_follow_button.html.twig' %}
                </div>
            </div>
        </div>

    </div>

    {% if user.about %}
        <div class="about p-3 pt-0">
            <p>{{ user.about|markdown|raw }}</p>
        </div>
    {% endif %}

    {% include 'user/_instance_info.twig' %}
    {% include 'user/_title.html.twig' %}
    {% include 'user/_nav.html.twig' %}
    <div class="kbin-user-front-page kbin-entry-list kbin-comment-wrapper kbin-post-wrapper">
        {% if results|length %}
            {% for subject in results %}
                {% include '_layout/_subject.html.twig' with {subject: subject, withParent: false, nested:false} %}
            {% endfor %}
        {% else %}
            {{ not_found() }}
        {% endif %}

        {% if(pagination.haveToPaginate) %}
            {{ pagerfanta(pagination, null, {'pageParameter':'[p]'}) }}
        {% endif %}
    </div>
{% endblock %}

{% block sidebar %}
    {% include 'user/_sidebar.html.twig' %}
    {{ parent() }}
    <div class="mb-4">
        {% include 'user/_moderator_list_card.html.twig' %}
    </div>
{% endblock %}
